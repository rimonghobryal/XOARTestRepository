category: Utilities
commonfields:
  id: LGTM
  version: -1
configuration:
- defaultvalue: https://lgtm.com/api/v1.0
  display: Server URL (e.g. https://lgtm.com/api/v1.0)
  name: url
  required: true
  type: 0
- display: API Key
  name: api_key
  required: true
  type: 4
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.0.0
    itemVersion: 1.1.8
    packID: DevSecOps
    packName: DevSecOps
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: An Integration with LGTM API
detaileddescription: |-
  ### Community Contributed Integration
   #### Integration Author: Ayman Mahmoud
   No support or maintenance is provided by the author. Customers are encouraged to engage with the user community for questions and guidance at the [Cortex XSOAR Live Discussions](https://live.paloaltonetworks.com/t5/cortex-xsoar-discussions/bd-p/Cortex_XSOAR_Discussions).
  ***
  ## LGTM
  LGTM is a code analysis platform for finding zero-days and preventing critical vulnerabilities

  ### Generate an API Token
  1. Login to your LGTM service account, go to **Account Settings**.
  2. Click the **+Create Token** button in the **Your authorized applications** section
  3. Generate a Token with selected Scopes and Permissions as needed.
  4. Copy and paste the key.
  5. From the ID column, copy the Key ID.

  ### URL
  The Base URL of LGTM API v1.0: https://lgtm.com/api/v1.0



  ---
  [View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/lgtm)
display: LGTM (Community Contribution)
image: data:image/png;base64,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
name: LGTM
script:
  commands:
  - arguments:
    - description: The URL of the repository to analyze. LGTM tests this against the
        [repository providers](https://lgtm.com/admin/help/adding-repository-providers)
        defined for the system. If it doesn't match any of them, the request fails.
      name: repository
      required: true
    - description: Optional, a [language code](https://lgtm.com/help/lgtm/analysis-faqs#which-languages-are-supported)
        to specify which language to analyze. To request the analysis of more than
        one language, specify a query  meter for each language. By default, LGTM tries
        to analyze all supported languages.
      isArray: true
      name: language
    - description: The analysis mode of the new project. When set to `full` all commits
        of the project are analyzed; when set to `sparse` the latest commit of the
        project is analyzed periodically; when set to `upload`, no automatic analysis
        is performed, instead externally-generated databases should be uploaded. For
        new projects the default value is `full`. The `mode` meter cannot be used
        to change the analysis mode of existing projects. Therefore, for existing
        projects, it should either be left blank or set to match the analysis mode
        of the project.
      name: mode
    - description: Required when `mode=upload`, specify the identifier of the commit
        used to generate the database.
      name: commit
    - description: Optional when `mode=upload`, specify the date and time of the commit
        used to generate the database; defaults to the current time.
      name: date
    - description: 'Optional, any [labels](https://lgtm.com/admin/help/defining-worker-labels)
        required by workers to analyze this project. To specify more than one label,
        repeat the query  meter. '
      isArray: true
      name: worker-label
    description: Add a project to LGTM
    name: lgtm-add-project
  - arguments:
    - description: The analysis identifier.
      name: analysis-id
      required: true
    - description: The desired version of the SARIF format. Currently supported versions
        are `1.0.0`, `2.0.0`, and `2.1.0`.
      name: sarif-version
    - description: Set `true` to include results in files that are excluded from the
        output by default. This includes results in test code and generated files.
        For more information, see [File classification](https://lgtm.com/help/lgtm/file-classification).
      name: excluded-files
    description: Get detailed alert information
    name: lgtm-get-alerts
    outputs:
    - contextPath: LGTM.alerts.runs.results.ruleId
      description: LGTM Alerts by Rule ID
      type: Unknown
    - contextPath: LGTM.alerts.runs.results.partialFingerprints.primaryLocationLineHash
      description: LGTM Alert location by line hash
      type: Unknown
  - arguments:
    - description: The analysis identifier.
      name: analysis-id
      required: true
    description: Get analysis summary
    name: lgtm-get-analysis
    outputs:
    - contextPath: LGTM.analysis_summary.id
      description: The analysis identifier.
      type: String
    - contextPath: LGTM.analysis_summary.commit-id
      description: The commit identifier. The commit identifier is included only if
        the same commit was successfully analyzed for all languages. A detailed  eakdown
        of which commit was analyzed for each language is provided in the `languages`
        property.
      type: String
    - contextPath: LGTM.analysis_summary.languages.language
      description: The short name for the language.
      type: String
    - contextPath: LGTM.analysis_summary.languages.status
      description: The status of the analysis of this language.
      type: String
    - contextPath: LGTM.analysis_summary.languages.alerts
      description: The number of alerts for this language.
      type: Number
    - contextPath: LGTM.analysis_summary.languages.lines
      description: The number of lines of code for this language.
      type: Number
    - contextPath: LGTM.analysis_summary.languages.commit-id
      description: The latest successfully analyzed commit for the language. All statistics
        refer to this commit.
      type: String
    - contextPath: LGTM.analysis_summary.languages.commit-date
      description: The time of the commit.
      type: String
    - contextPath: LGTM.analysis_summary.languages.analysis-date
      description: The time the commit was analyzed.
      type: String
    - contextPath: LGTM.analysis_summary.log-url
      description: A page on LGTM to view the logs for this analysis.
      type: String
    - contextPath: LGTM.analysis_summary.results-url
      description: A page on LGTM to view the results of this analysis.
      type: String
  - arguments:
    - description: The numeric project identifier.
      name: project-id
      required: true
    - description: The identifier of a specific commit. Alternatively, use `latest`
        for the most recent analyzed commit.
      name: commit-id
      required: true
    description: Get analysis summary for a specific commit
    name: lgtm-get-analysis-for-commit
    outputs:
    - contextPath: LGTM.analysis_summary.id
      description: The analysis identifier.
      type: String
    - contextPath: LGTM.analysis_summary.commit-id
      description: The commit identifier. The commit identifier is included only if
        the same commit was successfully analyzed for all languages. A detailed  eakdown
        of which commit was analyzed for each language is provided in the `languages`
        property.
      type: String
    - contextPath: LGTM.analysis_summary.languages.language
      description: The short name for the language.
      type: String
    - contextPath: LGTM.analysis_summary.languages.status
      description: The status of the analysis of this language.
      type: String
    - contextPath: LGTM.analysis_summary.languages.alerts
      description: The number of alerts for this language.
      type: Number
    - contextPath: LGTM.analysis_summary.languages.lines
      description: The number of lines of code for this language.
      type: Number
    - contextPath: LGTM.analysis_summary.languages.commit-id
      description: The latest successfully analyzed commit for the language. All statistics
        refer to this commit.
      type: String
    - contextPath: LGTM.analysis_summary.languages.commit-date
      description: The time of the commit.
      type: String
    - contextPath: LGTM.analysis_summary.languages.analysis-date
      description: The time the commit was analyzed.
      type: String
    - contextPath: LGTM.analysis_summary.log-url
      description: A page on LGTM to view the logs for this analysis.
      type: String
    - contextPath: LGTM.analysis_summary.results-url
      description: A page on LGTM to view the results of this analysis.
      type: String
  - arguments:
    - description: The identifier for the review (from the `task-result-url`).
      name: review-id
      required: true
    description: Get results of code review
    name: lgtm-get-code-review
    outputs:
    - contextPath: LGTM.code_review_result.id
      description: The identifier for the review.
      type: String
    - contextPath: LGTM.code_review_result.results-url
      description: A page on LGTM to view the status and results of this code review.
      type: String
    - contextPath: LGTM.code_review_result.status
      description: The status of the code review.
      type: String
    - contextPath: LGTM.code_review_result.status-message
      description: A summary of the current status of the code review.
      type: String
    - contextPath: LGTM.code_review_result.languages.language
      description: The language analyzed.
      type: String
    - contextPath: LGTM.code_review_result.languages.status
      description: The status for analysis of this language.
      type: String
    - contextPath: LGTM.code_review_result.languages.status-message
      description: The current state of analysis of this langauge. When available,
        a summary of analysis results.
      type: String
    - contextPath: LGTM.code_review_result.languages.new
      description: The total number of alerts introduced by the patch for this language.
      type: Number
    - contextPath: LGTM.code_review_result.languages.fixed
      description: The total number of alerts fixed by the patch for this language.
      type: Number
    - contextPath: LGTM.code_review_result.languages.alerts.new
      description: The number of alerts introduced by the patch for this query.
      type: Number
    - contextPath: LGTM.code_review_result.languages.alerts.fixed
      description: The number of alerts fixed by the patch for this query.
      type: Number
  - arguments:
    - description: The numeric project identifier
      name: project-id
      required: true
    description: Get project by numeric identifier
    name: lgtm-get-project
    outputs:
    - contextPath: LGTM.project_details.languages.grade
      description: The grade of the code for this language.
      type: String
    - contextPath: LGTM.project_details.id
      description: LGTM Project id
      type: Unknown
    - contextPath: LGTM.project_details.name
      description: LGTM Project name
      type: Unknown
  - arguments:
    - description: The first part of the URL identifier of a project, which represents
        the repository host.
      name: provider
      required: true
    - description: The second part of the URL identifier of a project, the organization.
      name: org
      required: true
    - description: The third part of the URL identifier of a project, the repository
        name.
      name: name
      required: true
    description: Get project by URL identifier
    name: lgtm-get-project-by-url-identifier
    outputs:
    - contextPath: LGTM.project_details.languages.grade
      description: The grade of the code for this language.
      type: String
    - contextPath: LGTM.project_details.id
      description: LGTM Project id
      type: Unknown
    - contextPath: LGTM.project_details.name
      description: LGTM Project name
      type: Unknown
  - arguments:
    - description: The numeric project identifier
      name: project-id
      required: true
    - description: 'The type of project configuration to retrieve. If this  meter
        isn''t specified, the request retrieves the effective configuration. That
        is, the configuration that is actually applied to the project, which may be
        from: the repository the administrator-set, project configuration the global
        configuration. If you do specify this value, it must be one of: `repository`
        to retrieve the configuration specified by a YAML file in the repository.
        A 404 status is returned if there is no repository configuration. `administrator`
        to retrieve the administrator-set, project configuration. A 404 status is
        returned if there is no administrator configuration.'
      name: source
    description: Get configuration for a project identified by numeric identifier
    name: lgtm-get-project-config
  - arguments:
    - description: The maximum number of projects to return in each response (1-100).
      name: limit
    - description: An opaque identifier generated by the API.
      name: start
    description: List projects
    name: lgtm-get-projects
    outputs:
    - contextPath: LGTM.project-list.data.id
      description: The numeric identifier of the project.
      type: Number
    - contextPath: LGTM.project-list.data.url-identifier
      description: The URL identifier of the project.
      type: String
    - contextPath: LGTM.project-list.data.name
      description: The display name of the project.
      type: String
    - contextPath: LGTM.project-list.data.url
      description: The full URL of the project on LGTM.
      type: String
    - contextPath: LGTM.project-list.nextPageUrl
      description: The URL to retrieve the next page of projects. Omitted if there
        is no next page.
      type: String
  - arguments: []
    description: Version information
    name: lgtm-get-version
    outputs:
    - contextPath: LGTM.version.apiVersion
      description: The version number of the API.
      type: String
  - arguments:
    - description: The numeric project identifier.
      name: project-id
      required: true
    - description: The identifier of the commit to analyze.
      name: commit
      required: true
    - description: The language codes of the languages to analyze. For a list of available
        languages, see [Supported languages](https://lgtm.com/help/lgtm/analysis-faqs#which-languages-are-supported).
        To specify more than one language, this  meter can be repeated. If no language
        is specified, all the project's languages will be analyzed.
      isArray: true
      name: language
    description: Run analysis of a specific commit
    name: lgtm-request-analysis
    outputs:
    - contextPath: LGTM.analysis.id
      description: LGTM request id
      type: Unknown
    - contextPath: LGTM.analysis.status
      description: LGTM analysis status
      type: Unknown
    - contextPath: LGTM.analysis_request.task-result.id
      description: LGTM analysis task id
      type: Unknown
    - contextPath: LGTM.analysis_request.task-result.commit-id
      description: LGTM analysis commit id
      type: Unknown
  - arguments:
    - description: The numeric project identifier.
      name: project-id
      required: true
    - description: The identifier for the base commit.
      name: base
      required: true
    - description: Your reference number for the code review.
      name: external-id
      required: true
    - description: The callback URL for LGTM to post to on completion of the review.
        When the code review is complete, the API sends an HTTP POST request to the
        callback URL with the result of the code review in the request body. The code
        review results in the request body are identical to the results accessed through
        the [`/codereviews/{review-id}`](https://lgtm.com/help/lgtm/api/api-v1#opIdgetCodeReview)
        end-point. If you specify a `callback-secret`, the request also includes an
        `x-lgtm-signature` header with a digital signature of the request's contents.
      name: callback-url
    - description: The `callback-secret` is used to compute a signature which is included
        in the `x-lgtm-signature` header of the callback response. The receiver of
        the callback can check the validity of the response by computing the signature
        using HMAC-SHA1 and verifying that it matches the `x-lgtm-signature` header
        value. The HMAC algorithm requires byte sequences as inputs for both the secret
        and the message. The callback secret string must be converted to bytes using
        UTF-8 encoding. The response body should ideally be read as a plain byte sequence.
        Conversion to, for example a JSON object, and back to a byte sequence might
        change the formatting, and would invalidate the signature.
      name: callback-secret
    - description: Entry ID of the Patch File , you can use git diff --binary to generate
        patch file
      name: patch-entry-id
      required: true
    description: Run code review for a patch
    name: lgtm-request-review
    outputs:
    - contextPath: LGTM.code_review_request.id
      description: LGTM Code Review request id
      type: Unknown
    - contextPath: LGTM.code_review_request.status
      description: LGTM Code Review request status
      type: Unknown
    - contextPath: LGTM.code_review_request.task-result.id
      description: LGTM Code Review request task id
      type: Unknown
  - arguments:
    - description: The [language](https://lgtm.com/help/lgtm/analysis-faqs#which-languages-are-supported)
        you want to analyze.
      name: language
      required: true
    - description: The identifier of the project to analyze. Either `project-id` or
        `projects-list` must be specified.
      isArray: true
      name: project-id
      required: true
    - description: The CodeQL query stored in an XSOAR list
      name: query-list
      required: true
    description: Run a CodeQL query on one or more projects
    name: lgtm-create-query-job
    outputs:
    - contextPath: LGTM.Queries.task-result.id
      description: Query ID
      type: Unknown
  - arguments:
    - description: The identifier of the query job, from the `task-result` given in
        the response to the initial `POST /queryjobs` request.
      name: queryjob-id
      required: true
    description: Get the status of a query job
    name: lgtm-get-query-job
    outputs:
    - contextPath: LGTM.queryjob.id
      description: The identifier for the QueryJob.
      type: String
  - arguments:
    - description: The identifier of the query job, from the `task-result` given in
        the response to the initial `POST /queryjobs` request.
      name: queryjob-id
      required: true
    - description: The identifier for the project.
      name: project-id
      required: true
    - description: Start point for the page of results.
      name: start
    - description: The maximum number of results to display (less than 100).
      name: limit
    - description: Include results that are not part of the source tree. These results
        are filtered out by default.
      name: nofilter
    description: Fetch the results of a query job for a specific project
    name: lgtm-get-query-job-results-for-project
    outputs:
    - contextPath: LGTM.queryjob-project-results.data.line
      description: LGTM Query Job Project Data Line
      type: Number
    - contextPath: LGTM.queryjob-project-results.data.file
      description: LGTM Query Job Project Data File
      type: String
    - contextPath: LGTM.queryjob-project-results.data.value
      description: LGTM Query Job Project Data Value
      type: String
    - contextPath: LGTM.queryjob-project-results.data.url
      description: LGTM Query Job Project Data URL
      type: String
    - contextPath: LGTM.queryjob-project-results.next
      description: URL for retrieving the next part of the results (if applicable).
      type: String
    - contextPath: LGTM.queryjob_project_results.project.id
      description: Project ID
      type: Unknown
  - arguments:
    - description: The identifier of the query job, from the `task-result` given in
        the response to the initial `POST /queryjobs` request.
      name: queryjob-id
      required: true
    description: Provide a summary of results for the projects in the query job
    name: lgtm-get-query-job-results-overview
    outputs:
    - contextPath: LGTM.queryjob-results-overview.data.status
      description: Describes whether the query was sucessfully executed against the
        project.
      type: String
    - contextPath: LGTM.queryjob-results-overview.data.total
      description: Number of results returned by the query. This is  oken down further
        into `internal` and `external` results. Only applies if `status` is `success`.
      type: Number
    - contextPath: LGTM.queryjob-results-overview.data.internal
      description: Number of results that refer to elements within the source tree.
        Only applies if `status` is `success`.
      type: Number
    - contextPath: LGTM.queryjob-results-overview.data.external
      description: Number of results that refer to elements outside the source tree
        (e.g., li aries). Only applies if `status` is `success`.
      type: Number
    - contextPath: LGTM.queryjob-results-overview.data.error
      description: Error message. Only applies if `status` is `error`.
      type: String
    - contextPath: LGTM.queryjob-results-overview.next
      description: LGTM Query Job Results Overview Next
      type: String
  dockerimage: demisto/python3:3.10.12.63474
  runonce: false
  script: |
    register_module_line('LGTM', 'start', __line__())
    ### pack version: 1.1.8

    import urllib3



    class Client(BaseClient):
        def __init__(self, server_url, verify, proxy, headers, auth):
            super().__init__(base_url=server_url, verify=verify, proxy=proxy, headers=headers, auth=auth)

        def abort_upload_request(self, session_id):
            response = self._http_request('delete', f'snapshots/uploads/{session_id}')

            return response

        def add_project_request(self, repository, language, mode, commit, date, worker_label):
            params = assign_params(repository=repository, language=language, mode=mode,
                                   commit=commit, date=date, worker_label=worker_label)
            headers = self._headers
            headers['Content-Type'] = 'application/x-yaml'
            response = self._http_request('post', 'projects', params=params, headers=headers)

            return response

        def get_alerts_request(self, analysis_id, sarif_version, excluded_files):
            params = assign_params(sarif_version=sarif_version, excluded_files=excluded_files)
            response = self._http_request('get', f'analyses/{analysis_id}/alerts', params=params)

            return response

        def get_analysis_request(self, analysis_id):
            response = self._http_request('get', f'analyses/{analysis_id}')

            return response

        def get_analysis_for_commit_request(self, project_id, commit_id):
            response = self._http_request('get', f'analyses/{project_id}/commits/{commit_id}')

            return response

        def get_code_review_request(self, review_id):
            response = self._http_request('get', f'codereviews/{review_id}')

            return response

        def get_project_request(self, project_id):
            response = self._http_request('get', f'projects/{project_id}')

            return response

        def get_project_by_url_identifier_request(self, provider, org, name):
            response = self._http_request('get', f'projects/{provider}/{org}/{name}')

            return response

        def get_project_config_request(self, project_id, source):
            params = assign_params(source=source)
            response = self._http_request(
                'get', f'projects/{project_id}/settings/analysis-configuration', params=params, resp_type='text')

            return response

        def get_projects_request(self, limit, start):
            params = assign_params(limit=limit, start=start)
            response = self._http_request('get', 'projects', params=params)

            return response

        def get_version_request(self):
            response = self._http_request('get', '')

            return response

        def request_analysis_request(self, project_id, commit, language):
            params = assign_params(commit=commit, language=language)
            response = self._http_request('post', f'analyses/{project_id}', params=params)

            return response

        def request_review_request(self, project_id, base, external_id,
                                   callback_url, callback_secret, patch_file):
            params = {
                "base": base,
                "external-id": external_id,
                "callback-url": callback_url,
                "callback-secret": callback_secret
            }
            headers = self._headers
            headers['Content-Type'] = 'application/octet-stream'
            response = self._http_request('post', f'codereviews/{project_id}', params=params,
                                          headers=headers, files=patch_file)

            return response

        def create_query_job_request(self, language, project_id, query):
            parameters = {
                'project-id': project_id,
                'language': language
            }
            response = self._http_request('post', 'queryjobs', params=parameters, data=query)

            return response

        def get_query_job_request(self, queryjob_id):
            response = self._http_request('get', f'queryjobs/{queryjob_id}')

            return response

        def get_query_job_results_for_project_request(self, queryjob_id, project_id, start, limit, nofilter):
            params = assign_params(start=start, limit=limit, nofilter=nofilter)
            response = self._http_request('get', f'queryjobs/{queryjob_id}/results/{project_id}', params=params)

            return response

        def get_query_job_results_overview_request(self, queryjob_id):
            response = self._http_request('get', f'queryjobs/{queryjob_id}/results')

            return response


    def add_project_command(client, args):
        repository = str(args.get('repository', ''))
        language = argToList(args.get('language', []))
        mode = str(args.get('mode', ''))
        commit = str(args.get('commit', ''))
        date = str(args.get('date', ''))
        worker_label = argToList(args.get('worker-label', []))

        response = client.add_project_request(repository, language, mode, commit, date, worker_label)
        command_results = CommandResults(
            outputs_prefix='LGTM',
            outputs_key_field='',
            outputs=response,
            raw_response=response
        )

        return command_results


    def get_alerts_command(client, args):
        analysis_id = str(args.get('analysis-id', ''))
        sarif_version = str(args.get('sarif-version', ''))
        excluded_files = argToBoolean(args.get('excluded-files', False))

        response = client.get_alerts_request(analysis_id, sarif_version, excluded_files)
        command_results = CommandResults(
            outputs_prefix='LGTM.alerts',
            outputs_key_field='',
            outputs=response,
            raw_response=response
        )

        return command_results


    def get_analysis_command(client, args):
        analysis_id = str(args.get('analysis-id', ''))

        response = client.get_analysis_request(analysis_id)
        command_results = CommandResults(
            outputs_prefix='LGTM.analysis_summary',
            outputs_key_field='id',
            outputs=response,
            raw_response=response
        )

        return command_results


    def get_analysis_for_commit_command(client, args):
        project_id = args.get('project-id', None)
        commit_id = str(args.get('commit-id', ''))

        response = client.get_analysis_for_commit_request(project_id, commit_id)
        command_results = CommandResults(
            outputs_prefix='LGTM.analysis_summary',
            outputs_key_field='id',
            outputs=response,
            raw_response=response
        )

        return command_results


    def get_code_review_command(client, args):
        review_id = str(args.get('review-id', ''))

        response = client.get_code_review_request(review_id)
        command_results = CommandResults(
            outputs_prefix='LGTM.code_review_result',
            outputs_key_field='id',
            outputs=response,
            raw_response=response
        )

        return command_results


    def get_project_command(client, args):
        project_id = args.get('project-id', None)

        response = client.get_project_request(project_id)
        command_results = CommandResults(
            outputs_prefix='LGTM.project_details',
            outputs_key_field='id',
            outputs=response,
            raw_response=response
        )

        return command_results


    def get_project_by_url_identifier_command(client, args):
        provider = str(args.get('provider', ''))
        org = str(args.get('org', ''))
        name = str(args.get('name', ''))

        response = client.get_project_by_url_identifier_request(provider, org, name)
        command_results = CommandResults(
            outputs_prefix='LGTM.project_details',
            outputs_key_field='id',
            outputs=response,
            raw_response=response
        )

        return command_results


    def get_project_config_command(client, args):
        project_id = args.get('project-id', None)
        source = str(args.get('source', ''))

        response = client.get_project_config_request(project_id, source)
        human_readable = tableToMarkdown(t=response, name='Project Config', headers='Config')

        command_results = CommandResults(
            outputs_prefix='LGTM.config',
            outputs_key_field='',
            outputs=response,
            readable_output=human_readable,
            raw_response=response
        )

        return command_results


    def get_projects_command(client, args):
        limit = args.get('limit', None)
        start = str(args.get('start', ''))

        response = client.get_projects_request(limit, start)
        command_results = CommandResults(
            outputs_prefix='LGTM.project_list',
            outputs_key_field='id',
            outputs=response,
            raw_response=response
        )

        return command_results


    def get_version_command(client, args):

        response = client.get_version_request()
        command_results = CommandResults(
            outputs_prefix='LGTM.version',
            outputs_key_field='',
            outputs=response,
            raw_response=response
        )

        return command_results


    def request_analysis_command(client, args):
        project_id = args.get('project-id', None)
        commit = str(args.get('commit', ''))
        language = argToList(args.get('language', []))

        response = client.request_analysis_request(project_id, commit, language)
        command_results = CommandResults(
            outputs_prefix='LGTM.analysis_request',
            outputs_key_field='id',
            outputs=response,
            raw_response=response
        )

        return command_results


    def request_review_command(client, args):
        project_id = args.get('project-id', None)
        base = str(args.get('base', ''))
        external_id = args.get('external-id', None)
        callback_url = str(args.get('callback-url', ''))
        callback_secret = str(args.get('callback-secret', ''))
        patch_file_entry_id = args.get('patch-entry-id', None)

        patch_file_info = demisto.getFilePath(patch_file_entry_id)
        uploaded_patch_file = open(patch_file_info['path'], 'rb')
        patch_file = {'file': (patch_file_info['name'], uploaded_patch_file)}

        response = client.request_review_request(project_id, base, external_id, callback_url, callback_secret, patch_file)
        command_results = CommandResults(
            outputs_prefix='LGTM.code_review_request',
            outputs_key_field='id',
            outputs=response,
            raw_response=response
        )

        return command_results


    def create_query_job_command(client, args):
        language = str(args.get('language', ''))
        project_id = argToList(args.get('project-id', []))
        query = str(args.get('query-list', ''))

        response = client.create_query_job_request(language, project_id, query)
        command_results = CommandResults(
            outputs_prefix='LGTM.queryjob',
            outputs_key_field='LGTM.queryjob.task-result.id',
            outputs=response,
            raw_response=response
        )

        return command_results


    def get_query_job_command(client, args):
        queryjob_id = str(args.get('queryjob-id', ''))

        response = client.get_query_job_request(queryjob_id)
        command_results = CommandResults(
            outputs_prefix='LGTM.queryjob',
            outputs_key_field='LGTM.queryjob.id',
            outputs=response,
            raw_response=response
        )

        return command_results


    def get_query_job_results_for_project_command(client, args):
        queryjob_id = str(args.get('queryjob-id', ''))
        project_id = str(args.get('project-id', ''))
        start = args.get('start', None)
        limit = args.get('limit', None)
        nofilter = argToBoolean(args.get('nofilter', False))

        response = client.get_query_job_results_for_project_request(queryjob_id, project_id, start, limit, nofilter)
        command_results = CommandResults(
            outputs_prefix='LGTM.queryjob_project_results',
            outputs_key_field='',
            outputs=response,
            raw_response=response
        )

        return command_results


    def get_query_job_results_overview_command(client, args):
        queryjob_id = str(args.get('queryjob-id', ''))

        response = client.get_query_job_results_overview_request(queryjob_id)
        command_results = CommandResults(
            outputs_prefix='LGTM.queryjob_results_overview',
            outputs_key_field='',
            outputs=response,
            raw_response=response
        )

        return command_results


    def test_module(client):
        # Test functions here
        client.get_version_request()
        demisto.results('ok')


    def main():

        params = demisto.params()
        args = demisto.args()
        url = params.get('url')
        verify_certificate = not params.get('insecure', False)
        proxy = params.get('proxy', False)
        headers = {}
        headers['Authorization'] = 'Bearer ' + f'{params["api_key"]}'
        headers['Content-Type'] = 'text/plain'

        command = demisto.command()
        LOG(f'Command being called is {command}')

        try:
            urllib3.disable_warnings()
            client = Client(urljoin(url, ""), verify_certificate, proxy, headers=headers, auth=None)
            commands = {
                'lgtm-add-project': add_project_command,
                'lgtm-create-query-job': create_query_job_command,
                'lgtm-get-alerts': get_alerts_command,
                'lgtm-get-analysis': get_analysis_command,
                'lgtm-get-analysis-for-commit': get_analysis_for_commit_command,
                'lgtm-get-code-review': get_code_review_command,
                'lgtm-get-project': get_project_command,
                'lgtm-get-project-by-url-identifier': get_project_by_url_identifier_command,
                'lgtm-get-project-config': get_project_config_command,
                'lgtm-get-projects': get_projects_command,
                'lgtm-get-query-job': get_query_job_command,
                'lgtm-get-query-job-results-for-project': get_query_job_results_for_project_command,
                'lgtm-get-query-job-results-overview': get_query_job_results_overview_command,
                'lgtm-get-version': get_version_command,
                'lgtm-request-analysis': request_analysis_command,
                'lgtm-request-review': request_review_command
            }

            if command == 'test-module':
                test_module(client)

            else:
                return_results(commands[command](client, args))

        except Exception as e:
            return_error(str(e))


    if __name__ in ['__main__', 'builtin', 'builtins']:
        main()

    register_module_line('LGTM', 'end', __line__())
  subtype: python3
  type: python
system: true
